# Problem
Can you understand the language and answer the questions to retrieve the flag? Connect to the service with ```nc 2018shell1.picoctf.com 7866```

## Hints:
Maybe try writing a python script?

## Solution:
Lets connect:
```bash
nc 2018shell1.picoctf.com 7866

Rules:
() + () = ()()                                      => [combine]
((())) + () = ((())())                              => [absorb-right]
() + ((())) = (()(()))                              => [absorb-left]
(())(()) + () = (())(()())                          => [combined-absorb-right]
() + (())(()) = (()())(())                          => [combined-absorb-left]
(())(()) + ((())) = ((())(())(()))                  => [absorb-combined-right]
((())) + (())(()) = ((())(())(()))                  => [absorb-combined-left]
() + (()) + ((())) = (()()) + ((())) = ((()())(())) => [left-associative]

Example: 
(()) + () = () + (()) = (()())

Let's start with a warmup.
(()(())) + () = ???

> 
```

After putting my blood, sweat, and tears into this, I understood the rule.
The the deepest expression aosorbs the other.

My code:
```python
#!/usr/bin/env python
from pwn import *

    
def get_max_depth(s):
    d = 0
    max_d = 0

    for ss in s:
        if ss == '(':
            d += 1

        if ss == ')':
            d -= 1

        if d > max_d:
            max_d = d

    return max_d

def add_nodes(n1, n2):
    d1 = get_max_depth(n1)
    d2 = get_max_depth(n2)

    if d1 < d2:
        return n2[0] + n1 + n2[1:]
    elif d1 == d2:
        return n1 + n2
    else:
        return n1[:-1] + n2 + n1[-1]

def main():
    r = remote('2018shell1.picoctf.com', 7866)

    ci = 1
    while True:
        lines = r.recvrepeat(0.2).split('\n')
        
        print '\n'.join(lines)

        if 'pico' in '\n'.join(lines):
            break

        q = lines[-3].split('=')[0].strip()
        log.info('Got challenge #{}: {}'.format(ci, q))
        q = q.split()

        queries = { }

        while len(q) > 1:
            n1 = q.pop(0)
            q.pop(0)
            n2 = q.pop(0)

            n = add_nodes(n1, n2)

            q = [n] + q

        log.info('Sending: {}'.format(q[0]))
        r.sendline(q[0])

        ll = r.recvuntil('\n')

        print ll

        ci += 1

if __name__ == '__main__':
    main()
```

Output:
```
[+] Opening connection to 2018shell1.picoctf.com on port 7866: Done
Rules:
() + () = ()()                                      => [combine]
((())) + () = ((())())                              => [absorb-right]
() + ((())) = (()(()))                              => [absorb-left]
(())(()) + () = (())(()())                          => [combined-absorb-right]
() + (())(()) = (()())(())                          => [combined-absorb-left]
(())(()) + ((())) = ((())(())(()))                  => [absorb-combined-right]
((())) + (())(()) = ((())(())(()))                  => [absorb-combined-left]
() + (()) + ((())) = (()()) + ((())) = ((()())(())) => [left-associative]

Example: 
(()) + () = () + (()) = (()())

Let's start with a warmup.
(()()) + (()(())) = ???

> 
[*] Got challenge #1: (()()) + (()(()))
[*] Sending: ((()())()(()))
Correct!


Okay, now we're cookin!
((())()) + (()()) + ()()() = ???

> 
[*] Got challenge #2: ((())()) + (()()) + ()()()
[*] Sending: ((())()(()())()()())
Correct!


Alright see if you can get this one.
() + ((())()) + (()()()(())()()) + (()()) + ((())()) = ???

> 
[*] Got challenge #3: () + ((())()) + (()()()(())()()) + (()()) + ((())())
[*] Sending: (()(())())(()()()(())()()(()()))((())())
Correct!


This one's a little bigger!
(()()) + (()()()) + (()()()) + (((()())()())()) + (()(())((()))(((())))((((()))))) + (()) + ()() + (((()(())((()))(((())))()()))()) + ()()() + (()(((()()())()())()())) = ???

> 
[*] Got challenge #4: (()()) + (()()()) + (()()()) + (((()())()())()) + (()(())((()))(((())))((((()))))) + (()) + ()() + (((()(())((()))(((())))()()))()) + ()()() + (()(((()()())()())()()))
[*] Sending: ((((()())(()()())(()()())((()())()())())()(())((()))(((())))((((()))))(())()())((()(())((()))(((())))()()))()()()()(()(((()()())()())()())))
Correct!


Ha. No more messin around. Final Round.
((()()(())(()()()()()()()()))((()())()())()) + (((()()())(())())()(())((()))(((())))((((()))))) + (((()()()(())()())((()())()())())((((()))))(((())))((()))(())()) + ((()()()()()()(())()())((()(())((()))(((())))()()))()) + (()()()()) + (((()()(()))()(((()()())()())()()))((((()))))(((())))((()))(())()) + ((()()()()())((()())()())()) + ((()(()))((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())) + ((()()()()()()()())()()()(())()()) + (((()()())()(()))((()())()())()) + ((()()())()(((()()())()())()())) + ((()()(())(()()()))((((()))))(((())))((()))(())()) + (((())()(()()()()()()()()))((()())()())()) + (()(())()()()()(()()()()()()()())) + ((()())(())())(()()()(())()()) + ((()())(()()())()(())((()))(((())))((((()))))) + (((()()(()))((()())()())())()(())((()))(((())))((((()))))) + ((()()()()()()()())((()(())((()))(((())))()()))()) + (((()()()())((()())()())())()(())((()))(((())))((((()))))) + ((()()(())(()))((()(())((()))(((())))()()))()) + (()()()((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())) + (()()(()))((())()()()) + (()()())(()()()()()()()()) + ((()())()(())(()()()))(()()()(())()()) + (()()(()))((())()()()()) + ((()(())())((()())()())()) + ((())()(())(()()())) + (()(())()()(()()())) + ((()()()()(((()()())()())()()))((((()))))(((())))((()))(())()) + (()(())()()()()(()()()()()()()())) + (()()()()()()) + ((()()()(((()()())()())()()))((()(())((()))(((())))()()))()) + (()()(()))((())()(()()()()()()()())) + (()()(()))((())()(())) + (((()()())((()())()())())((((()))))(((())))((()))(())()) + ((()()()()()()(())()())()(())((()))(((())))((((()))))) + (((()())(())())((()(())((()))(((())))()()))()) + ((()(())())((()())()())()) + (()(())()(())(()()())) + ((()()()()()(())()())()(((()()())()())()())) + ((()())(()()())((()())()())()) + (((()())()(((()()())()())()()))((((()))))(((())))((()))(())()) + ((()(())(()))()(((()()())()())()())) + ((()())()(())(()()()()()()()()))(()()()(())()()) + ((()())((()(())((()))(((())))()()))()(()(())((()))(((())))((((())))))) + (((()()()()()()()()())((()())()())())((((()))))(((())))((()))(())()) + (((()())()(())(()()()()()()()()))()(((()()())()())()())) + (()()()((((()))))(((())))((()))(())()) + (((()())()(()))((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())) + (()())(()()()()()()()()) = ???

> 
[*] Got challenge #5: ((()()(())(()()()()()()()()))((()())()())()) + (((()()())(())())()(())((()))(((())))((((()))))) + (((()()()(())()())((()())()())())((((()))))(((())))((()))(())()) + ((()()()()()()(())()())((()(())((()))(((())))()()))()) + (()()()()) + (((()()(()))()(((()()())()())()()))((((()))))(((())))((()))(())()) + ((()()()()())((()())()())()) + ((()(()))((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())) + ((()()()()()()()())()()()(())()()) + (((()()())()(()))((()())()())()) + ((()()())()(((()()())()())()())) + ((()()(())(()()()))((((()))))(((())))((()))(())()) + (((())()(()()()()()()()()))((()())()())()) + (()(())()()()()(()()()()()()()())) + ((()())(())())(()()()(())()()) + ((()())(()()())()(())((()))(((())))((((()))))) + (((()()(()))((()())()())())()(())((()))(((())))((((()))))) + ((()()()()()()()())((()(())((()))(((())))()()))()) + (((()()()())((()())()())())()(())((()))(((())))((((()))))) + ((()()(())(()))((()(())((()))(((())))()()))()) + (()()()((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())) + (()()(()))((())()()()) + (()()())(()()()()()()()()) + ((()())()(())(()()()))(()()()(())()()) + (()()(()))((())()()()()) + ((()(())())((()())()())()) + ((())()(())(()()())) + (()(())()()(()()())) + ((()()()()(((()()())()())()()))((((()))))(((())))((()))(())()) + (()(())()()()()(()()()()()()()())) + (()()()()()()) + ((()()()(((()()())()())()()))((()(())((()))(((())))()()))()) + (()()(()))((())()(()()()()()()()())) + (()()(()))((())()(())) + (((()()())((()())()())())((((()))))(((())))((()))(())()) + ((()()()()()()(())()())()(())((()))(((())))((((()))))) + (((()())(())())((()(())((()))(((())))()()))()) + ((()(())())((()())()())()) + (()(())()(())(()()())) + ((()()()()()(())()())()(((()()())()())()())) + ((()())(()()())((()())()())()) + (((()())()(((()()())()())()()))((((()))))(((())))((()))(())()) + ((()(())(()))()(((()()())()())()())) + ((()())()(())(()()()()()()()()))(()()()(())()()) + ((()())((()(())((()))(((())))()()))()(()(())((()))(((())))((((())))))) + (((()()()()()()()()())((()())()())())((((()))))(((())))((()))(())()) + (((()())()(())(()()()()()()()()))()(((()()())()())()())) + (()()()((((()))))(((())))((()))(())()) + (((()())()(()))((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())) + (()())(()()()()()()()())
[*] Sending: ((((()()(())(()()()()()()()()))((()())()())())((()()())(())())()(())((()))(((())))((((())))))(((()()()(())()())((()())()())())((((()))))(((())))((()))(())())(()()()()()()(())()())((()(())((()))(((())))()()))()(()()()())(((()()(()))()(((()()())()())()()))((((()))))(((())))((()))(())())((()()()()())((()())()())()))((()(()))((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())((()()()()()()()())()()()(())()())(((()()())()(()))((()())()())())((()()())()(((()()())()())()()))((()()(())(()()()))((((()))))(((())))((()))(())())(((())()(()()()()()()()()))((()())()())())(()(())()()()()(()()()()()()()()))((()())(())())(()()()(())()())((()())(()()())()(())((()))(((())))((((())))))(((()()(()))((()())()())())()(())((()))(((())))((((()))))))((()()()()()()()())((()(())((()))(((())))()()))()(((()()()())((()())()())())()(())((()))(((())))((((()))))))((()()(())(()))((()(())((()))(((())))()()))())(()()()((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())(()()(()))((())()()())(()()())(()()()()()()()())((()())()(())(()()()))(()()()(())()())(()()(()))((())()()()())((()(())())((()())()())())((())()(())(()()()))(()(())()()(()()()))((()()()()(((()()())()())()()))((((()))))(((())))((()))(())())(()(())()()()()(()()()()()()()()))(()()()()()()))((()()()(((()()())()())()()))((()(())((()))(((())))()()))()(()()(()))((())()(()()()()()()()()))(()()(()))((())()(()))(((()()())((()())()())())((((()))))(((())))((()))(())())((()()()()()()(())()())()(())((()))(((())))((((()))))))(((()())(())())((()(())((()))(((())))()()))()((()(())())((()())()())())(()(())()(())(()()()))((()()()()()(())()())()(((()()())()())()()))((()())(()()())((()())()())())(((()())()(((()()())()())()()))((((()))))(((())))((()))(())())((()(())(()))()(((()()())()())()()))((()())()(())(()()()()()()()()))(()()()(())()()))((()())((()(())((()))(((())))()()))()(()(())((()))(((())))((((())))))(((()()()()()()()()())((()())()())())((((()))))(((())))((()))(())())(((()())()(())(()()()()()()()()))()(((()()())()())()()))(()()()((((()))))(((())))((()))(())()))(((()())()(()))((()(())((()))(((())))()()))()(((((()))))(((())))((()))(())())(()())(()()()()()()()()))
Correct!


Congratulations, here's your flag: picoCTF{5cr1pt1nG_l1k3_4_pRo_45ca3f85}

[*] Closed connection to 2018shell1.picoctf.com port 7866

```

Flag: picoCTF{5cr1pt1nG_l1k3_4_pRo_45ca3f85}