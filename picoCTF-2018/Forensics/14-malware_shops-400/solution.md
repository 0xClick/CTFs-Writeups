# Problem
There has been some [malware](https://2018shell1.picoctf.com/static/e5ae3cc615c8876300ddfdb49ab52872/plot.png) detected, can you help with the analysis? More [info](https://2018shell1.picoctf.com/static/e5ae3cc615c8876300ddfdb49ab52872/info.txt) here. Connect with ```nc 2018shell1.picoctf.com 18874```.

## Hints:

## Solution:
First, we download the files:
```bash
wget https://2018shell1.picoctf.com/static/e5ae3cc615c8876300ddfdb49ab52872/plot.png
wget https://2018shell1.picoctf.com/static/e5ae3cc615c8876300ddfdb49ab52872/info.txt
cat ./info.txt
xdg-open ./plot.png

You've been given a dataset of about 500 malware binary files that have
been found on your organization's computers. Whenever you find more malware,
you want to be able to tell if you've seen a file like this before.

Binary files are hard to understand. When code is written, there are several
more steps before it becomes software. Some parts of this process are:
i.  Compiling, which turns human-readable source code into assembly code.
    Assembly code is difficult for humans to read, but it closely mimics the most
    basic raw instructions that a computer needs in order to run a program.
ii. Assembling, which turns assembly code into machine code. Machine code is
    impossible for humans to read, but this representation is what a computer
    actually needs to execute.

The malware binary files that were given to you to analyze are all in machine
code, but luckily, you were able to run a program called a disassembler to
turn them back into assembly code.

Assembly code contains *instructions* which tell a computer how to update
its own internal memory, and its progress through reading the assembly code
itself. For instance, the `jmp` instruction means "jump to executing a
different instruction", and the `add` instruction means "add two numbers and
store the result in memory".

Your dataset contains data about all the malware files, including their
file hash, which serves as a name, and the counts of all of the `jmp` and `add`
instructions.

Malware attackers often release many slightly different versions of the same
malware over time. These different versions always have totally different
hashes, but they are likely to have similar numbers of `jmp` and `add`
instructions.
```

![plot](./plot.png)

Now lets connect:
```bash
nc 2018shell1.picoctf.com 3693

You'll need to consult the file `clusters.png` to answer the following questions.


How many attackers created the malware in this dataset?
```

Some questions about the plot. We can answer them manually, or write a script:
```python
#!/usr/bin/env python

from pwn import *


plot = {
	'00:00:00': 11000,
	'00:15:00': 11000,
	'00:30:00': 11000,
	'00:45:00': 11000,

	'01:00:00': 11000,
	'01:15:00': 11000,
	'01:30:00': 11000,
	'01:45:00': 11000,

	'02:00:00': 11000,
	'02:15:00': 11000,
	'02:30:00': 11000,
	'02:45:00': 11000,

	'03:00:00': 11000,
	'03:15:00': 11000,
	'03:30:00': 11000,
	'03:45:00': 11000,

	'04:00:00': 11000,
	'04:15:00': 11000,
	'04:30:00': 11000,
	'04:45:00': 11000,

	'05:00:00': 11000,
	'05:15:00': 11000,
	'05:30:00': 11000,
	'05:45:00': 11000,

	'06:00:00': 11000,
	'06:15:00': 11000,
	'06:30:00': 11000,
	'06:45:00': 11000,

	'07:00:00': 11000,
	'07:15:00': 11000,
	'07:30:00': 12000,
	'07:45:00': 12750,

	'08:00:00': 13750,
	'08:15:00': 12750,
	'08:30:00': 12000,
	'08:45:00': 11000,

	'09:00:00': 11000,
	'09:15:00': 11000,
	'09:30:00': 11000,
	'09:45:00': 11000,

	'10:00:00': 11000,
	'10:15:00': 11000,
	'10:30:00': 11000,
	'10:45:00': 11000,

	'11:00:00': 12000,
	'11:15:00': 13000,
	'11:30:00': 14800,
	'11:45:00': 17000,

	'12:00:00': 17000,
	'12:15:00': 16000,
	'12:30:00': 15000,
	'12:45:00': 12800,

	'13:00:00': 12000,
	'13:15:00': 12000,
	'13:30:00': 11000,
	'13:45:00': 11000,

	'14:00:00': 11000,
	'14:15:00': 11000,
	'14:30:00': 11000,
	'14:45:00': 11000,

	'15:00:00': 11000,
	'15:15:00': 11000,
	'15:30:00': 11000,
	'15:45:00': 11000,

	'16:00:00': 11000,
	'16:15:00': 11000,
	'16:30:00': 11000,
	'16:45:00': 11000,

	'17:00:00': 11000,
	'17:15:00': 12300,
	'17:30:00': 12800,
	'17:45:00': 13250,

	'18:00:00': 15000,
	'18:15:00': 15500,
	'18:30:00': 16000,
	'18:45:00': 15500,

	'19:00:00': 15250,
	'19:15:00': 13500,
	'19:30:00': 12750,
	'19:45:00': 12000,

	'20:00:00': 11500,
	'20:15:00': 11000,
	'20:30:00': 11000,
	'20:45:00': 11000,

	'21:00:00': 11000,
	'21:15:00': 11000,
	'21:30:00': 11000,
	'21:45:00': 11000,

	'22:00:00': 11000,
	'22:15:00': 11000,
	'22:30:00': 11000,
	'22:45:00': 11000,

	'23:00:00': 11000,
	'23:15:00': 11000,
	'23:30:00': 11000,
	'23:45:00': 11000,

}

r = remote('2018shell1.picoctf.com', 18874)

sleep(0.5)
print r.recv()

log.info('Sending: {}'.format(5))
r.sendline('5')

sleep(0.5)
lines = r.recv().split('\n')

print '\n'.join(lines)

h = lines[3].split()[22][:-1]
log.info('Reference hash is: {}'.format(h))

l = [l for l in lines if h in l][1]
ratio = float(l.split()[2]) / float(l.split()[3])
log.info('Jmp/Add ration is: {}'.format(str(ratio)))

best_hash = -1
diff = 10

for i, l in enumerate(lines[5:-1]):
	if h in l:
		continue

	l = l.split()
	if abs((float(l[2]) / float(l[3])) - ratio) < diff:
		diff = abs((float(l[2]) / float(l[3])) - ratio)
		best_hash = l[1]

log.info('Sending: {}'.format(best_hash))
r.sendline(best_hash)
print r.recv()
```

Flag: picoCTF{w4y_0ut_08631993}